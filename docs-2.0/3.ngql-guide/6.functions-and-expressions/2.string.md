# 内置字符串函数

本文介绍 Nebula Graph 支持的字符串函数。

## 注意事项

- 字符串的表示方式为用双引号或单引号包裹。

- 和 SQL 一样，nGQL 的字符索引（位置）从`1`开始。但是 C 语言的字符索引是从`0`开始的。

- 如果参数为`NULL`，则输出结果是未定义的。

## strcasecmp()

strcasecmp()比较两个字符串（不区分大小写）。

语法：`strcasecmp(<string_a>,<string_b>)`

- `string_a`、`string_b`：待比较的字符串。

- 返回类型：int。

- 当 `string_a = string_b` 时，返回 `0`，当 `string_a > string_b` 是，返回大于 `0` 的数，当 `string_a < string_b` 时，返回小于 `0` 的数。

示例：

```ngql
nebula> RETURN strcasecmp("a","aa");
+----------------------+
| strcasecmp("a","aa") |
+----------------------+
| -97                  |
+----------------------+
```

## lower() 和 toLower()

lower()和 toLower()都可以返回指定字符串的小写形式。

语法：`lower(<string>)`、`toLower(<string>)`

- `string`：指定的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN lower("Basketball_Player");
+----------------------------+
| lower("Basketball_Player") |
+----------------------------+
| "basketball_player"        |
+----------------------------+
```

## upper() 和 toUpper()

upper()和 toUpper()都可以返回指定字符串的大写形式。

语法：`upper(<string>)`、`toUpper(<string>)`

- `string`：指定的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN upper("Basketball_Player");
+----------------------------+
| upper("Basketball_Player") |
+----------------------------+
| "BASKETBALL_PLAYER"        |
+----------------------------+
```

## length()

length()返回指定字符串的长度，单位：字节。

语法：`length(<string>)`

- `string`：指定的字符串。

- 返回类型：int。

示例：

```ngql
nebula> RETURN length("basketball");
+----------------------+
| length("basketball") |
+----------------------+
| 10                   |
+----------------------+
```

## trim()

trim()删除指定字符串头部和尾部的空格。

语法：`trim(<string>)`

- `string`：指定的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN trim(" basketball player ");
+-----------------------------+
| trim(" basketball player ") |
+-----------------------------+
| "basketball player"         |
+-----------------------------+
```

## ltrim()

ltrim()删除字符串头部的空格。

语法：`ltrim(<string>)`

- `string`：指定的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN ltrim(" basketball player ");
+------------------------------+
| ltrim(" basketball player ") |
+------------------------------+
| "basketball player "         |
+------------------------------+
```

## rtrim()

rtrim()删除字符串尾部的空格。

语法：`rtrim(<string>)`

- `string`：指定的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN rtrim(" basketball player ");
+------------------------------+
| rtrim(" basketball player ") |
+------------------------------+
| " basketball player"         |
+------------------------------+
```

## left()

left()返回指定字符串头部若干个字符组成的子字符串。

语法：`left(<string>,<count>)`

- `string`：指定的字符串。

- `count`：指定从头部开始的字符数量。如果`count`超过字符串的长度，则返回字符串本身。

- 返回类型：string。

示例：

```ngql
nebula> RETURN left("basketball_player",6);
+-----------------------------+
| left("basketball_player",6) |
+-----------------------------+
| "basket"                    |
+-----------------------------+
```

## right()

right()返回指定字符串尾部若干个字符组成的子字符串。

语法：`right(<string>,<count>)`

- `string`：指定的字符串。

- `count`：指定从尾部开始的字符数量。如果`count`超过字符串的长度，则返回字符串本身。

- 返回类型：string。

示例：

```ngql
nebula> RETURN right("basketball_player",6);
+------------------------------+
| right("basketball_player",6) |
+------------------------------+
| "player"                     |
+------------------------------+
```

## lpad()

lpad()在指定字符串的头部填充字符串，并返回从尾部开始指定长度的字符串。

语法：`lpad(<string>,<count>,<letters>)`

- `string`：指定的字符串。

- `count`：指定从尾部开始将要返回的字符数量。如果`count`少于`string`字符串的长度，则只返回`string`字符串**从前到后**的`count`个字符。

- `letters`：从头部填充的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN lpad("abcd",10,"b");
+---------------------+
| lpad("abcd",10,"b") |
+---------------------+
| "bbbbbbabcd"        |
+---------------------+

nebula> RETURN lpad("abcd",3,"b");
+--------------------+
| lpad("abcd",3,"b") |
+--------------------+
| "abc"              |
+--------------------+
```

## rpad()

rpad()在指定字符串的尾部填充字符串，并返回从头部开始指定长度的字符串。

语法：`rpad(<string>,<count>,<letters>)`

- `string`：指定的字符串。

- `count`：指定从头部开始将要返回的字符数量。如果`count`少于`string`字符串的长度，则只返回`string`字符串**从前到后**的`count`个字符。

- `letters`：从尾部填充的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN rpad("abcd",10,"b");
+---------------------+
| rpad("abcd",10,"b") |
+---------------------+
| "abcdbbbbbb"        |
+---------------------+

nebula> RETURN rpad("abcd",3,"b");
+--------------------+
| rpad("abcd",3,"b") |
+--------------------+
| "abc"              |
+--------------------+
```

## substr() 和 substring()

substr()和 substring()从指定字符串的指定位置开始（不包括开始位置的字符），提取后面的若干个字符，组成新的字符串并返回。

语法：`substr(<string>,<pos>,<count>)`、`substring(<string>,<pos>,<count>)`

- `string`：指定的字符串。

- `pos`：指定开始的位置，即字符索引，数据类型为 int。

- `count`：指定从开始位置往后提取的字符数量。

- 返回类型：string。

### `substr()`和`substring()`的返回说明

- 如果`pos`为 0，表示从指定字符串头部开始提取（包括第一个字符）。

- 如果`pos`大于最大字符索引，则返回空字符串。

- 如果`pos`是负数，则返回`BAD_DATA`。

- 如果省略`count`，则返回从`pos`位置开始到字符串末尾的子字符串。

- 如果`count`为 0，则返回空字符串。

- 使用`NULL`作为任何参数会出现[错误](https://github.com/vesoft-inc/nebula-graph/issues/878)。

!!! compatibility "openCypher 兼容性"

    在 openCypher 中，如果字符串`a`为`null`，会返回`null`。

示例：

```ngql
nebula> RETURN substr("abcdefg",2,4);
+-----------------------+
| substr("abcdefg",2,4) |
+-----------------------+
| "cdef"                |
+-----------------------+

nebula> RETURN substr("abcdefg",0,4);
+-----------------------+
| substr("abcdefg",0,4) |
+-----------------------+
| "abcd"                |
+-----------------------+

nebula> RETURN substr("abcdefg",2);
+---------------------+
| substr("abcdefg",2) |
+---------------------+
| "cdefg"             |
+---------------------+
```

## reverse()

reverse()逆序返回指定的字符串。

语法：`reverse(<string>)`

- `string`：指定的字符串。

- 返回类型：string。

示例：

```ngql
nebula> RETURN reverse("abcdefg");
+--------------------+
| reverse("abcdefg") |
+--------------------+
| "gfedcba"          |
+--------------------+
```

## replace()

replace()将指定字符串中的子字符串 a 替换为字符串 b。

语法：`replace(<string>,<substr_a>,<string_b>)`

- `string`：指定的字符串。

- `substr_a`：子字符串 a。

- `string_b`：字符串 b。

- 返回类型：string。

示例：

```ngql
nebula> RETURN replace("abcdefg","cd","AAAAA");
+---------------------------------+
| replace("abcdefg","cd","AAAAA") |
+---------------------------------+
| "abAAAAAefg"                    |
+---------------------------------+
```

## split()

split()将子字符串 b 识别为分隔符，分隔指定字符串，并返回分隔后的字符串列表。

语法：`split(<string>,<substr>)`

- `string`：指定的字符串。

- `substr`：子字符串 b。

- 返回类型：list。

示例：

```ngql
nebula> RETURN split("basketballplayer","a");
+-------------------------------+
| split("basketballplayer","a") |
+-------------------------------+
| ["b", "sketb", "llpl", "yer"] |
+-------------------------------+
```

## toString()

toString()将任意非复合数据类型数据转换为字符串类型。

语法：`toString(<value>)`

- `value`：待转换的数据。

- 返回类型：string。

示例：

```ngql
nebula> RETURN toString(true);
+----------------+
| toString(true) |
+----------------+
| "true"         |
+----------------+

nebula> RETURN toString(12345);
+-----------------+
| toString(12345) |
+-----------------+
| "12345"         |
+-----------------+
```

## hash()

hash()获取指定字符串的哈希值。

语法：`hash(<string>)`

- `string`：指定的字符串。

- 返回类型：int。

示例：

```ngql
nebula> RETURN hash("abcde");
+--------------------+
| hash("abcde")      |
+--------------------+
| 811036730794841393 |
+--------------------+
```
